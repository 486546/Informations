# 最小生成树
太简单了，反正就是 `kruskal` 就完了。\
证明有诸多，最有名的还是反证法。

---

反证法：我们假设我们求出的 $MST$ ，即最小生成树，是 $T$ ，最优的是 $B$ ，则 $T\neq B$ 。\
任取 $e\in B$ 但 $e\notin T$ 。则 $T$ 上 $u\rightarrow v$ 是一个环，设其为 $R$ 。\
那么 $e$ 就是 $R$ 上边权最大的边了。然而既然 $e$ 是最大的边，我们就会用 $e$ 来更新最小的 $MST$ ，与最优的 $B$ 矛盾。\
证毕。

---

~~到这里就结束了。拜拜~~ \
等等还不行。\
一个 `kruskal` 的时间复杂度会不会受并查集的影响呢？

---

并查集的时间复杂度是 $O(n\alpha (n))$ 。\
其中 $alpha(n)$ 为反阿克曼函数。\
阿克曼函数为 $f(1)=1,f(i)=2^{f(i-1)}(i \ge 2)$ 。\
那么反阿克曼函数就非常小了，一般 `OI` 中的数据大小也就 $n \leq 10^6$ ，此时 $\alpha(n)$ 就差不多也就 $5$ 或 $6$ 吧……。\
下面我们来看看几个例题。

---

# [Minimum spanning tree for each edge](https://www.luogu.com.cn/problem/CF609E)

## 题面翻译

### 题目描述

给你 $n$ 个点， $m$ 条边，如果对于一个最小生成树中要求必须包括第 $i(1 \le i \le m)$ 条边，那么最小生成树的权值总和最小是多少。

### 输入格式

第一行有两个整数 $n$ 和 $m$。

接下来 $m$ 行，每行有三个整数 $u$， $v$ 和 $w$ 表示一条权值为 $w$ 的边连接 $u$ 和 $v$。

### 输出格式

总共 $m$ 行，第 $i$ 行一个整数代表包括第 $i$ 条边时的最小权值和。

### 说明/提示

$1 \le n \le 2 \times 10^5,n-1 \le m\le 2 \times 10^5$

$1 \le u_i,v_i \le n,u_i \neq v_i,1 \le w_i \le 10^9$
## 样例 #1

### 样例输入 #1

```
5 7
1 2 3
1 3 1
1 4 5
2 3 2
2 5 3
3 4 2
4 5 4
```

### 样例输出 #1

```
9
8
11
8
8
8
9
```
解法：我们考虑一开始就求最小生成树，先算最小生成树，然后去强行加上第 $i$ 条边，此时必然会出现环，然后在环内找到除 $i$ 外最大边权，删去即可。\
用树链剖分求出环上的最大值就行了。
